Scriptname HealthExploitFix_Script extends ActiveMagicEffect

Quest property brawlQuest auto
_RespawnOverhaulMCM property mcmOptions auto
GlobalVariable Property PlayerBleedingOut Auto

Event OnEnterBleedout()
    If brawlQuest.GetStage() > 0 && brawlQuest.GetStage() < 250
        return
    EndIf

    PlayerBleedingOut.SetValueInt(1)
    Game.DisablePlayerControls(True, True, False, False, True, True, True, True)
    Utility.Wait(mcmOptions._respawnDelay)
    If ! Game.GetPlayer().IsBleedingOut()
        Game.EnablePlayerControls()
    EndIf
    PlayerBleedingOut.SetValueInt(0)
EndEvent